---
id: 16629962-bb60-4718-ad83-7da6c0705c9e
---

sequenceDiagram
    participant Client as Client (HTTP)
    participant Starter as HTTP Starter (/autogensocial/orchestrate)
    participant Orchestrator as Durable Orchestrator
    participant Copywriter as Copywriter Agent (Azure Foundry)
    participant ImageAgent as Image Agent (Azure Foundry)
    participant Publish as publish_post activity
    participant Status as HTTP Status (/check_task_status)
    participant Cosmos as Cosmos DB
    participant Blob as Blob Storage
    participant Trace as TraceLogger

    Orchestrator->>Copywriter: call_activity(brandId, postPlanId)
    Copywriter->>Cosmos: Read brand & plan
    Copywriter->>Cosmos: Upsert contentRef + caption
    Copywriter-->>Orchestrator: contentRef

    Orchestrator->>ImageAgent: call_activity(contentRef)
    ImageAgent->>Cosmos: Read contentRef
    ImageAgent->>Blob: Create/store image
    Blob-->>ImageAgent: mediaRef
    ImageAgent->>Cosmos: Upsert mediaRef
    ImageAgent-->>Orchestrator: mediaRef

    Orchestrator->>Image: call_activity(contentRef)
    Image->>Cosmos: Read contentRef
    Image->>Blob: Create/store image
    Blob-->>Image: mediaRef
    Image->>Cosmos: Upsert mediaRef
    Image-->>Orchestrator: mediaRef

    Orchestrator->>Publish: call_activity(contentRef, mediaRef)
    Publish->>Cosmos: Upsert final post
    Publish-->>Orchestrator: postRef
    Orchestrator->>Trace: Log(done)

    Client->>Status: GET /check_task_status?instanceId=...
    Status->>Orchestrator: get_status(instanceId)
    Orchestrator-->>Status: runtime status + post
    Status-->>Client: StatusResponse
